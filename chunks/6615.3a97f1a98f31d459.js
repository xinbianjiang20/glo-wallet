"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6615],{79724:function(e,a,t){t.d(a,{fetchAllSecretBalances:function(){return o}});var n=t(24658),r=t(37955),s=t(97006),c=t(93093);const o=async(e,a,t,o)=>{if(!o)return[];await o.enable(s.vo.SECRET);const i=new r.SecretNetworkClient({url:e.rest,chainId:s.vo.SECRET,wallet:o.getOfflineSignerOnlyAmino(s.vo.SECRET),encryptionUtils:o.getEnigmaUtils(s.vo.SECRET),walletAddress:a}),l=await(async(e,a,t)=>{const n=a.join("_"),r="perm_".concat(e,"_").concat(n,"_").concat(t);let s;const c=window.localStorage.getItem(r);if(c&&(s=JSON.parse(c)),!s)try{s={params:{permit_name:"secret-bridge-balance",allowed_tokens:a,chain_id:e,permissions:["balance"]},signature:(await window.keplr.signAmino(e,t,{chain_id:e,account_number:"0",sequence:"0",fee:{amount:[{denom:"uscrt",amount:"0"}],gas:"1"},msgs:[{type:"query_permit",value:{permit_name:"secret-bridge-balance",allowed_tokens:a,permissions:["balance"]}}],memo:""},{preferNoSetFee:!0,preferNoSetMemo:!0})).signature},window.localStorage.setItem(r,JSON.stringify(s))}catch(o){console.error("--- PERMIT ERROR ---"),console.error(o)}return s})(s.vo.SECRET,t.map((e=>e.address)),a),d=await Promise.all(t.filter((e=>!!e.codeHash)).map((async e=>{var a;const t=await(async(e,a,t)=>{if(t){const n={balance:{}};return await e.query.compute.queryContract({contract_address:a.address,code_hash:a.codeHash,query:{with_permit:{query:n,permit:t}}})}return-1})(i,{address:e.address,codeHash:null!==(a=e.codeHash)&&void 0!==a?a:""},l);return{...e,balance:(0,c.Sk)(BigInt(t.balance.amount),null===e||void 0===e?void 0:e.decimals)}}))),u=await n.StargateClient.connect(e.rpc),m=t.find((e=>"uscrt"===e.address)),w=await u.getBalance(a,"uscrt");var p;return[...d,{...m,balance:(0,c.Sk)(BigInt(w.amount),null!==(p=null===m||void 0===m?void 0:m.decimals)&&void 0!==p?p:18)}]}}}]);